{
  "id": "ugc-video-creator-infinitetalk-optimized",
  "revision": 1,
  "last_node_id": 325,
  "last_link_id": 565,
  "nodes": [
    {
      "id": 321,
      "type": "Note",
      "pos": [-5250, -1700],
      "size": [900, 350],
      "flags": {},
      "order": 0,
      "mode": 0,
      "inputs": [],
      "outputs": [],
      "properties": {"widget_ue_connectable": {}},
      "widgets_values": [
        "UGC VIDEO CREATOR - InfiniteTalk Optimized\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n\nPIPELINE:\n1. AUDIO: MelBandRoFormer vocal isolation + Wav2Vec embeddings\n2. IMAGE: CLIP Vision encoding + VAE latent encoding\n3. VIDEO: Wan2.1 I2V 14B FP8 + InfiniteTalk lip-sync\n4. UPSCALE: Resize 480x832 -> 1080x1920 (TikTok 9:16)\n5. OUTPUT: H.264 MP4 25fps + audio sync\n\nINPUTS REQUIS:\n- 1 image portrait (visage clair, fond simple)\n- 1 fichier audio (voix du script UGC)\n\nMODELES REQUIS (~25GB):\n- Wan2_1-I2V-14B-480P_fp8_e4m3fn.safetensors\n- Wan2_1-InfiniteTalk-Single_fp8_e4m3fn_scaled_KJ.safetensors\n- lightx2v_I2V_14B_480p_cfg_step_distill_rank64_bf16.safetensors\n- Wan2_1_VAE_bf16.safetensors\n- umt5-xxl-enc-bf16.safetensors\n- clip_vision_h.safetensors\n- MelBandRoformer_fp16.safetensors\n- TencentGameMate/chinese-wav2vec2-base\n\nVRAM: ~16-24GB avec block swap | RESOLUTION: 480x832 -> 1080x1920"
      ],
      "color": "#324",
      "bgcolor": "#546"
    },
    {
      "id": 322,
      "type": "Note",
      "pos": [-4300, -1700],
      "size": [600, 350],
      "flags": {},
      "order": 1,
      "mode": 0,
      "inputs": [],
      "outputs": [],
      "properties": {"widget_ue_connectable": {}},
      "widgets_values": [
        "CONSEILS UGC:\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n\nIMAGE SOURCE:\n- Photo portrait frontale, bonne lumiere\n- Fond neutre ou lifestyle (pas trop charge)\n- Visage bien visible, bouche degagee\n- Format portrait (9:16) de preference\n\nAUDIO:\n- Enregistrer un script clair et dynamique\n- Pas de musique de fond (ou utiliser la separation vocale)\n- Duree recommandee: 15-30s pour TikTok/Reels\n- 44.1kHz ou 48kHz, mono ou stereo\n\nPARAMETRES:\n- Steps 10 = bon equilibre qualite/vitesse\n- CFG 1.2 = fidele au prompt\n- LoRA distill = acceleration ~2x\n- Block swap 10 = fonctionne avec 16-24GB VRAM\n- Augmenter block_swap si manque de VRAM\n\nFORMATS DE SORTIE:\n- TikTok/Reels: 1080x1920 (9:16) - DEFAUT\n- YouTube Shorts: 1080x1920 (9:16)\n- YouTube: changer resize en 1920x1080 (16:9)\n- Instagram: changer resize en 1080x1080 (1:1)"
      ],
      "color": "#432",
      "bgcolor": "#653"
    },
    {
      "id": 284,
      "type": "LoadImage",
      "pos": [-5200, -713],
      "size": [550, 500],
      "flags": {},
      "order": 2,
      "mode": 0,
      "inputs": [
        {"name": "image", "type": "COMBO", "widget": {"name": "image"}, "link": null},
        {"name": "upload", "type": "IMAGEUPLOAD", "widget": {"name": "upload"}, "link": null}
      ],
      "outputs": [
        {"name": "IMAGE", "type": "IMAGE", "slot_index": 0, "links": [496]},
        {"name": "MASK", "type": "MASK", "links": null}
      ],
      "title": "Avatar Source Image",
      "properties": {"cnr_id": "comfy-core", "ver": "0.3.50", "Node name for S&R": "LoadImage", "widget_ue_connectable": {"image": true, "upload": true}},
      "widgets_values": ["avatar.png", "image"],
      "color": "#322",
      "bgcolor": "#533"
    },
    {
      "id": 281,
      "type": "ImageResizeKJv2",
      "pos": [-4560, -625],
      "size": [281, 420],
      "flags": {},
      "order": 13,
      "mode": 0,
      "inputs": [
        {"name": "image", "type": "IMAGE", "link": 496},
        {"name": "mask", "shape": 7, "type": "MASK", "link": null},
        {"name": "width", "type": "INT", "widget": {"name": "width"}, "link": null},
        {"name": "height", "type": "INT", "widget": {"name": "height"}, "link": null},
        {"name": "upscale_method", "type": "COMBO", "widget": {"name": "upscale_method"}, "link": null},
        {"name": "keep_proportion", "type": "COMBO", "widget": {"name": "keep_proportion"}, "link": null},
        {"name": "pad_color", "type": "STRING", "widget": {"name": "pad_color"}, "link": null},
        {"name": "crop_position", "type": "COMBO", "widget": {"name": "crop_position"}, "link": null},
        {"name": "divisible_by", "type": "INT", "widget": {"name": "divisible_by"}, "link": null},
        {"name": "device", "shape": 7, "type": "COMBO", "widget": {"name": "device"}, "link": null}
      ],
      "outputs": [
        {"name": "IMAGE", "type": "IMAGE", "links": [538]},
        {"name": "width", "type": "INT", "links": []},
        {"name": "height", "type": "INT", "links": []},
        {"name": "mask", "type": "MASK", "links": null}
      ],
      "title": "Resize to Generation Size (480x832)",
      "properties": {"cnr_id": "comfyui-kjnodes", "ver": "f7eb33abc80a2aded1b46dff0dd14d07856a7d50", "Node name for S&R": "ImageResizeKJv2", "widget_ue_connectable": {"width": true, "height": true, "upscale_method": true, "keep_proportion": true, "pad_color": true, "crop_position": true, "divisible_by": true, "device": true}},
      "widgets_values": [480, 832, "lanczos", "crop", "0, 0, 0", "center", 16, "cpu"],
      "color": "#233",
      "bgcolor": "#355"
    },
    {
      "id": 291,
      "type": "GetImageSizeAndCount",
      "pos": [-4523, -686],
      "size": [483, 86],
      "flags": {"collapsed": true},
      "order": 15,
      "mode": 0,
      "inputs": [
        {"name": "image", "type": "IMAGE", "link": 538}
      ],
      "outputs": [
        {"name": "image", "type": "IMAGE", "links": [539, 540]},
        {"label": "480 width", "name": "width", "type": "INT", "links": [516]},
        {"label": "832 height", "name": "height", "type": "INT", "links": [517]},
        {"label": "1 count", "name": "count", "type": "INT", "links": null}
      ],
      "properties": {"cnr_id": "comfyui-kjnodes", "ver": "6dfd2c2420260dbb321a3412b9f1dff439a0f2e3", "Node name for S&R": "GetImageSizeAndCount", "widget_ue_connectable": {}},
      "widgets_values": []
    },
    {
      "id": 125,
      "type": "LoadAudio",
      "pos": [-3650, -1335],
      "size": [387, 160],
      "flags": {},
      "order": 3,
      "mode": 0,
      "inputs": [
        {"name": "audio", "type": "COMBO", "widget": {"name": "audio"}, "link": null},
        {"name": "audioUI", "type": "AUDIO_UI", "widget": {"name": "audioUI"}, "link": null},
        {"name": "upload", "type": "AUDIOUPLOAD", "widget": {"name": "upload"}, "link": null}
      ],
      "outputs": [
        {"name": "AUDIO", "type": "AUDIO", "slot_index": 0, "links": [554, 563]}
      ],
      "title": "UGC Voice Audio",
      "properties": {"cnr_id": "comfy-core", "ver": "0.3.41", "Node name for S&R": "LoadAudio", "widget_ue_connectable": {"audio": true, "audioUI": true, "upload": true}},
      "widgets_values": ["script_audio.mp3", null, null],
      "color": "#323",
      "bgcolor": "#535"
    },
    {
      "id": 301,
      "type": "MelBandRoFormerModelLoader",
      "pos": [-3650, -1107],
      "size": [390, 58],
      "flags": {},
      "order": 4,
      "mode": 0,
      "inputs": [
        {"name": "model_name", "type": "COMBO", "widget": {"name": "model_name"}, "link": null}
      ],
      "outputs": [
        {"name": "model", "type": "MELROFORMERMODEL", "links": [543]}
      ],
      "title": "Vocal Separation Model",
      "properties": {"cnr_id": "ComfyUI-MelBandRoFormer", "ver": "b68d9077815387b64d596f8c39607052b95b6eba", "Node name for S&R": "MelBandRoFormerModelLoader", "widget_ue_connectable": {"model_name": true}},
      "widgets_values": ["MelBandRoformer_fp16.safetensors"],
      "color": "#323",
      "bgcolor": "#535"
    },
    {
      "id": 302,
      "type": "MelBandRoFormerSampler",
      "pos": [-3225, -1273],
      "size": [223, 51],
      "flags": {},
      "order": 14,
      "mode": 0,
      "inputs": [
        {"name": "model", "type": "MELROFORMERMODEL", "link": 543},
        {"name": "audio", "type": "AUDIO", "link": 554}
      ],
      "outputs": [
        {"name": "vocals", "type": "AUDIO", "links": [544]},
        {"name": "instruments", "type": "AUDIO", "links": null}
      ],
      "title": "Isolate Vocals",
      "properties": {"cnr_id": "ComfyUI-MelBandRoFormer", "ver": "b68d9077815387b64d596f8c39607052b95b6eba", "Node name for S&R": "MelBandRoFormerSampler", "widget_ue_connectable": {}},
      "widgets_values": [],
      "color": "#323",
      "bgcolor": "#535"
    },
    {
      "id": 137,
      "type": "DownloadAndLoadWav2VecModel",
      "pos": [-3640, -991],
      "size": [389, 122],
      "flags": {},
      "order": 5,
      "mode": 0,
      "inputs": [
        {"name": "model", "type": "COMBO", "widget": {"name": "model"}, "link": null},
        {"name": "base_precision", "type": "COMBO", "widget": {"name": "base_precision"}, "link": null},
        {"name": "load_device", "type": "COMBO", "widget": {"name": "load_device"}, "link": null}
      ],
      "outputs": [
        {"name": "wav2vec_model", "type": "WAV2VECMODEL", "links": [334]}
      ],
      "title": "Wav2Vec Model (Audio Embeddings)",
      "properties": {"cnr_id": "ComfyUI-WanVideoWrapper", "ver": "058286fc0f3b0651a2f6b68309df3f06e8332cc0", "Node name for S&R": "DownloadAndLoadWav2VecModel", "widget_ue_connectable": {"model": true, "base_precision": true, "load_device": true}},
      "widgets_values": ["TencentGameMate/chinese-wav2vec2-base", "fp16", "main_device"],
      "color": "#323",
      "bgcolor": "#535"
    },
    {
      "id": 194,
      "type": "MultiTalkWav2VecEmbeds",
      "pos": [-3227, -1158],
      "size": [439, 284],
      "flags": {},
      "order": 16,
      "mode": 0,
      "inputs": [
        {"name": "wav2vec_model", "type": "WAV2VECMODEL", "link": 334},
        {"name": "audio_1", "type": "AUDIO", "link": 544},
        {"name": "audio_2", "shape": 7, "type": "AUDIO", "link": null},
        {"name": "audio_3", "shape": 7, "type": "AUDIO", "link": null},
        {"name": "audio_4", "shape": 7, "type": "AUDIO", "link": null},
        {"name": "ref_target_masks", "shape": 7, "type": "MASK", "link": null},
        {"name": "normalize_loudness", "type": "BOOLEAN", "widget": {"name": "normalize_loudness"}, "link": null},
        {"name": "num_frames", "type": "INT", "widget": {"name": "num_frames"}, "link": null},
        {"name": "fps", "type": "FLOAT", "widget": {"name": "fps"}, "link": null},
        {"name": "audio_scale", "type": "FLOAT", "widget": {"name": "audio_scale"}, "link": null},
        {"name": "audio_cfg_scale", "type": "FLOAT", "widget": {"name": "audio_cfg_scale"}, "link": null},
        {"name": "multi_audio_type", "type": "COMBO", "widget": {"name": "multi_audio_type"}, "link": null}
      ],
      "outputs": [
        {"name": "multitalk_embeds", "type": "MULTITALK_EMBEDS", "links": [357]},
        {"name": "audio", "type": "AUDIO", "links": null},
        {"name": "num_frames", "type": "INT", "links": [558]}
      ],
      "title": "Audio -> Lip-Sync Embeddings",
      "properties": {"cnr_id": "ComfyUI-WanVideoWrapper", "ver": "3d7801cee4c8e3106078dd9b9f146caee95069ba", "Node name for S&R": "MultiTalkWav2VecEmbeds", "widget_ue_connectable": {"normalize_loudness": true, "num_frames": true, "fps": true, "audio_scale": true, "audio_cfg_scale": true, "multi_audio_type": true}},
      "widgets_values": [true, 375, 25, 1, 1, "para"],
      "color": "#323",
      "bgcolor": "#535"
    },
    {
      "id": 293,
      "type": "PreviewAny",
      "pos": [-2987, -1311],
      "size": [210, 88],
      "flags": {},
      "order": 18,
      "mode": 0,
      "inputs": [
        {"name": "source", "type": "*", "link": 558}
      ],
      "outputs": [],
      "title": "Frame Count Preview",
      "properties": {"cnr_id": "comfy-core", "ver": "0.3.50", "Node name for S&R": "PreviewAny", "widget_ue_connectable": {}},
      "widgets_values": [],
      "color": "#323",
      "bgcolor": "#535"
    },
    {
      "id": 238,
      "type": "CLIPVisionLoader",
      "pos": [-4201, -688],
      "size": [417, 58],
      "flags": {},
      "order": 6,
      "mode": 0,
      "inputs": [
        {"name": "clip_name", "type": "COMBO", "widget": {"name": "clip_name"}, "link": null}
      ],
      "outputs": [
        {"name": "CLIP_VISION", "type": "CLIP_VISION", "links": [557]}
      ],
      "title": "CLIP Vision",
      "properties": {"cnr_id": "comfy-core", "ver": "0.3.50", "Node name for S&R": "CLIPVisionLoader", "widget_ue_connectable": {"clip_name": true}},
      "widgets_values": ["clip_vision_h.safetensors"],
      "color": "#233",
      "bgcolor": "#355"
    },
    {
      "id": 237,
      "type": "WanVideoClipVisionEncode",
      "pos": [-4207, -564],
      "size": [427, 359],
      "flags": {},
      "order": 17,
      "mode": 0,
      "inputs": [
        {"name": "clip_vision", "type": "CLIP_VISION", "link": 557},
        {"name": "image_1", "type": "IMAGE", "link": 539},
        {"name": "image_2", "shape": 7, "type": "IMAGE", "link": null},
        {"name": "negative_image", "shape": 7, "type": "IMAGE", "link": null},
        {"name": "strength_1", "type": "FLOAT", "widget": {"name": "strength_1"}, "link": null},
        {"name": "strength_2", "type": "FLOAT", "widget": {"name": "strength_2"}, "link": null},
        {"name": "crop", "type": "COMBO", "widget": {"name": "crop"}, "link": null},
        {"name": "combine_embeds", "type": "COMBO", "widget": {"name": "combine_embeds"}, "link": null},
        {"name": "force_offload", "type": "BOOLEAN", "widget": {"name": "force_offload"}, "link": null},
        {"name": "tiles", "shape": 7, "type": "INT", "widget": {"name": "tiles"}, "link": null},
        {"name": "ratio", "shape": 7, "type": "FLOAT", "widget": {"name": "ratio"}, "link": null}
      ],
      "outputs": [
        {"name": "image_embeds", "type": "WANVIDIMAGE_CLIPEMBEDS", "links": [433]}
      ],
      "title": "CLIP Vision Encode",
      "properties": {"cnr_id": "ComfyUI-WanVideoWrapper", "ver": "ff779c91714d8ee3484cd4119b082c72a1734b72", "Node name for S&R": "WanVideoClipVisionEncode", "widget_ue_connectable": {"strength_1": true, "strength_2": true, "crop": true, "combine_embeds": true, "force_offload": true, "tiles": true, "ratio": true}},
      "widgets_values": [1, 1, "center", "average", true, 0, 0.5],
      "color": "#233",
      "bgcolor": "#355"
    },
    {
      "id": 129,
      "type": "WanVideoVAELoader",
      "pos": [-3728, -715],
      "size": [417, 87],
      "flags": {},
      "order": 7,
      "mode": 0,
      "inputs": [
        {"name": "compile_args", "shape": 7, "type": "WANCOMPILEARGS", "link": null},
        {"name": "model_name", "type": "COMBO", "widget": {"name": "model_name"}, "link": null},
        {"name": "precision", "shape": 7, "type": "COMBO", "widget": {"name": "precision"}, "link": null}
      ],
      "outputs": [
        {"name": "vae", "type": "WANVAE", "slot_index": 0, "links": [556]}
      ],
      "title": "WAN VAE",
      "properties": {"cnr_id": "ComfyUI-WanVideoWrapper", "ver": "c3ee35f3ece76e38099dc516182d69b406e16772", "Node name for S&R": "WanVideoVAELoader", "widget_ue_connectable": {"model_name": true, "precision": true}},
      "widgets_values": ["Wan2_1_VAE_bf16.safetensors", "bf16"],
      "color": "#322",
      "bgcolor": "#533"
    },
    {
      "id": 192,
      "type": "WanVideoImageToVideoMultiTalk",
      "pos": [-3725, -577],
      "size": [415, 370],
      "flags": {},
      "order": 19,
      "mode": 0,
      "inputs": [
        {"name": "vae", "type": "WANVAE", "link": 556},
        {"name": "start_image", "shape": 7, "type": "IMAGE", "link": 540},
        {"name": "clip_embeds", "shape": 7, "type": "WANVIDIMAGE_CLIPEMBEDS", "link": 433},
        {"name": "width", "type": "INT", "widget": {"name": "width"}, "link": 516},
        {"name": "height", "type": "INT", "widget": {"name": "height"}, "link": 517},
        {"name": "frame_window_size", "type": "INT", "widget": {"name": "frame_window_size"}, "link": null},
        {"name": "motion_frame", "type": "INT", "widget": {"name": "motion_frame"}, "link": null},
        {"name": "force_offload", "type": "BOOLEAN", "widget": {"name": "force_offload"}, "link": null},
        {"name": "colormatch", "type": "COMBO", "widget": {"name": "colormatch"}, "link": null},
        {"name": "tiled_vae", "shape": 7, "type": "BOOLEAN", "widget": {"name": "tiled_vae"}, "link": null},
        {"name": "mode", "shape": 7, "type": "COMBO", "widget": {"name": "mode"}, "link": null},
        {"name": "output_path", "shape": 7, "type": "STRING", "widget": {"name": "output_path"}, "link": null}
      ],
      "outputs": [
        {"name": "image_embeds", "type": "WANVIDIMAGE_EMBEDS", "links": [413]},
        {"name": "output_path", "type": "STRING", "links": []}
      ],
      "title": "InfiniteTalk I2V (Lip-Sync)",
      "properties": {"cnr_id": "ComfyUI-WanVideoWrapper", "ver": "49430f900bf812a1e281560bafafd04c43dfdf13", "Node name for S&R": "WanVideoImageToVideoMultiTalk", "widget_ue_connectable": {"width": true, "height": true, "frame_window_size": true, "motion_frame": true, "force_offload": true, "colormatch": true, "tiled_vae": true, "mode": true, "output_path": true}},
      "widgets_values": [1080, 1920, 121, 13, false, "disabled", false, "infinitetalk", ""],
      "color": "#322",
      "bgcolor": "#533"
    },
    {
      "id": 241,
      "type": "WanVideoTextEncodeCached",
      "pos": [-3276, -717],
      "size": [470, 503],
      "flags": {},
      "order": 8,
      "mode": 0,
      "inputs": [
        {"name": "extender_args", "shape": 7, "type": "WANVIDEOPROMPTEXTENDER_ARGS", "link": null},
        {"name": "model_name", "type": "COMBO", "widget": {"name": "model_name"}, "link": null},
        {"name": "precision", "type": "COMBO", "widget": {"name": "precision"}, "link": null},
        {"name": "positive_prompt", "type": "STRING", "widget": {"name": "positive_prompt"}, "link": null},
        {"name": "negative_prompt", "type": "STRING", "widget": {"name": "negative_prompt"}, "link": null},
        {"name": "quantization", "type": "COMBO", "widget": {"name": "quantization"}, "link": null},
        {"name": "use_disk_cache", "type": "BOOLEAN", "widget": {"name": "use_disk_cache"}, "link": null},
        {"name": "device", "type": "COMBO", "widget": {"name": "device"}, "link": null}
      ],
      "outputs": [
        {"name": "text_embeds", "type": "WANVIDEOTEXTEMBEDS", "links": [437]},
        {"name": "negative_text_embeds", "type": "WANVIDEOTEXTEMBEDS", "links": null},
        {"name": "positive_prompt", "type": "STRING", "links": null}
      ],
      "title": "UGC Text Prompt",
      "properties": {"cnr_id": "ComfyUI-WanVideoWrapper", "ver": "ff779c91714d8ee3484cd4119b082c72a1734b72", "Node name for S&R": "WanVideoTextEncodeCached", "widget_ue_connectable": {"model_name": true, "precision": true, "positive_prompt": true, "negative_prompt": true, "quantization": true, "use_disk_cache": true, "device": true}},
      "widgets_values": [
        "umt5-xxl-enc-bf16.safetensors",
        "bf16",
        "A young person enthusiastically presenting a product to camera, holding it prominently, natural genuine smile, talking directly to camera with animated expressions, slight head movements and natural hand gestures while speaking, authentic UGC influencer energy, TikTok style selfie video, clean modern background softly blurred, soft natural lighting from front, professional smartphone camera quality, engaging and relatable, high quality detailed face, smooth natural lip movements synchronized with speech, realistic skin texture",
        "bright tones, overexposed, static, blurred details, subtitles, style, works, paintings, images, static, overall gray, worst quality, low quality, JPEG compression residue, ugly, incomplete, extra fingers, poorly drawn hands, poorly drawn faces, deformed, disfigured, misshapen limbs, fused fingers, still picture, messy background, three legs, many people in the background, walking backwards, unnatural mouth movements, frozen face",
        "disabled",
        false,
        "gpu"
      ],
      "color": "#432",
      "bgcolor": "#653"
    },
    {
      "id": 314,
      "type": "Note",
      "pos": [-4866, -1391],
      "size": [252, 184],
      "flags": {},
      "order": 9,
      "mode": 0,
      "inputs": [],
      "outputs": [],
      "properties": {"widget_ue_connectable": {}},
      "widgets_values": ["Si Triton est installe, connecter les Torch Compile Args au ModelLoader pour ~30% de vitesse en plus"],
      "color": "#432",
      "bgcolor": "#653"
    },
    {
      "id": 177,
      "type": "WanVideoTorchCompileSettings",
      "pos": [-4592, -1405],
      "size": [335, 206],
      "flags": {},
      "order": 10,
      "mode": 0,
      "inputs": [
        {"name": "backend", "type": "COMBO", "widget": {"name": "backend"}, "link": null},
        {"name": "fullgraph", "type": "BOOLEAN", "widget": {"name": "fullgraph"}, "link": null},
        {"name": "mode", "type": "COMBO", "widget": {"name": "mode"}, "link": null},
        {"name": "dynamic", "type": "BOOLEAN", "widget": {"name": "dynamic"}, "link": null},
        {"name": "dynamo_cache_size_limit", "type": "INT", "widget": {"name": "dynamo_cache_size_limit"}, "link": null},
        {"name": "compile_transformer_blocks_only", "type": "BOOLEAN", "widget": {"name": "compile_transformer_blocks_only"}, "link": null},
        {"name": "dynamo_recompile_limit", "shape": 7, "type": "INT", "widget": {"name": "dynamo_recompile_limit"}, "link": null}
      ],
      "outputs": [
        {"name": "torch_compile_args", "type": "WANCOMPILEARGS", "links": [552]}
      ],
      "title": "Torch Compile (Optional Speed Boost)",
      "properties": {"cnr_id": "ComfyUI-WanVideoWrapper", "ver": "f3614e6720744247f3211d60f7b9333f43572384", "Node name for S&R": "WanVideoTorchCompileSettings", "widget_ue_connectable": {"backend": true, "fullgraph": true, "mode": true, "dynamic": true, "dynamo_cache_size_limit": true, "compile_transformer_blocks_only": true, "dynamo_recompile_limit": true}},
      "widgets_values": ["inductor", false, "default", false, 64, true, 128],
      "color": "#223",
      "bgcolor": "#335"
    },
    {
      "id": 134,
      "type": "WanVideoBlockSwap",
      "pos": [-4210, -1420],
      "size": [501, 202],
      "flags": {},
      "order": 11,
      "mode": 0,
      "inputs": [
        {"name": "blocks_to_swap", "type": "INT", "widget": {"name": "blocks_to_swap"}, "link": null},
        {"name": "offload_img_emb", "type": "BOOLEAN", "widget": {"name": "offload_img_emb"}, "link": null},
        {"name": "offload_txt_emb", "type": "BOOLEAN", "widget": {"name": "offload_txt_emb"}, "link": null},
        {"name": "use_non_blocking", "shape": 7, "type": "BOOLEAN", "widget": {"name": "use_non_blocking"}, "link": null},
        {"name": "vace_blocks_to_swap", "shape": 7, "type": "INT", "widget": {"name": "vace_blocks_to_swap"}, "link": null},
        {"name": "prefetch_blocks", "shape": 7, "type": "INT", "widget": {"name": "prefetch_blocks"}, "link": null},
        {"name": "block_swap_debug", "shape": 7, "type": "BOOLEAN", "widget": {"name": "block_swap_debug"}, "link": null}
      ],
      "outputs": [
        {"name": "block_swap_args", "type": "BLOCKSWAPARGS", "links": [362]}
      ],
      "title": "VRAM Management (Block Swap)",
      "properties": {"cnr_id": "ComfyUI-WanVideoWrapper", "ver": "058286fc0f3b0651a2f6b68309df3f06e8332cc0", "Node name for S&R": "WanVideoBlockSwap", "widget_ue_connectable": {"blocks_to_swap": true, "offload_img_emb": true, "offload_txt_emb": true, "use_non_blocking": true, "vace_blocks_to_swap": true, "prefetch_blocks": true, "block_swap_debug": true}},
      "widgets_values": [10, false, false, true, 0, 1, false],
      "color": "#223",
      "bgcolor": "#335"
    },
    {
      "id": 138,
      "type": "WanVideoLoraSelect",
      "pos": [-4867, -1141],
      "size": [616, 150],
      "flags": {},
      "order": 12,
      "mode": 0,
      "inputs": [
        {"name": "prev_lora", "shape": 7, "type": "WANVIDLORA", "link": null},
        {"name": "blocks", "shape": 7, "type": "SELECTEDBLOCKS", "link": null},
        {"name": "lora", "type": "COMBO", "widget": {"name": "lora"}, "link": null},
        {"name": "strength", "type": "FLOAT", "widget": {"name": "strength"}, "link": null},
        {"name": "low_mem_load", "shape": 7, "type": "BOOLEAN", "widget": {"name": "low_mem_load"}, "link": null},
        {"name": "merge_loras", "shape": 7, "type": "BOOLEAN", "widget": {"name": "merge_loras"}, "link": null}
      ],
      "outputs": [
        {"name": "lora", "type": "WANVIDLORA", "links": [349]}
      ],
      "title": "Speed LoRA (Distill ~2x faster)",
      "properties": {"cnr_id": "ComfyUI-WanVideoWrapper", "ver": "058286fc0f3b0651a2f6b68309df3f06e8332cc0", "Node name for S&R": "WanVideoLoraSelect", "widget_ue_connectable": {"lora": true, "strength": true, "low_mem_load": true, "merge_loras": true}},
      "widgets_values": ["lightx2v_I2V_14B_480p_cfg_step_distill_rank64_bf16.safetensors", 1, false, false],
      "color": "#223",
      "bgcolor": "#335"
    },
    {
      "id": 120,
      "type": "MultiTalkModelLoader",
      "pos": [-4861, -928],
      "size": [632, 67],
      "flags": {},
      "order": 20,
      "mode": 0,
      "inputs": [
        {"name": "model", "type": "COMBO", "widget": {"name": "model"}, "link": null}
      ],
      "outputs": [
        {"name": "model", "type": "MULTITALKMODEL", "links": [355]}
      ],
      "title": "InfiniteTalk Model",
      "properties": {"cnr_id": "ComfyUI-WanVideoWrapper", "ver": "058286fc0f3b0651a2f6b68309df3f06e8332cc0", "Node name for S&R": "MultiTalkModelLoader", "widget_ue_connectable": {"model": true}},
      "widgets_values": ["Wan2_1-InfiniteTalk-Single_fp8_e4m3fn_scaled_KJ.safetensors"],
      "color": "#223",
      "bgcolor": "#335"
    },
    {
      "id": 122,
      "type": "WanVideoModelLoader",
      "pos": [-4222, -1169],
      "size": [518, 338],
      "flags": {},
      "order": 21,
      "mode": 0,
      "inputs": [
        {"name": "compile_args", "shape": 7, "type": "WANCOMPILEARGS", "link": 552},
        {"name": "block_swap_args", "shape": 7, "type": "BLOCKSWAPARGS", "link": 362},
        {"name": "lora", "shape": 7, "type": "WANVIDLORA", "link": 349},
        {"name": "vram_management_args", "shape": 7, "type": "VRAM_MANAGEMENTARGS", "link": null},
        {"name": "extra_model", "shape": 7, "type": "VACEPATH", "link": null},
        {"name": "fantasytalking_model", "shape": 7, "type": "FANTASYTALKINGMODEL", "link": null},
        {"name": "multitalk_model", "shape": 7, "type": "MULTITALKMODEL", "link": 355},
        {"name": "fantasyportrait_model", "shape": 7, "type": "FANTASYPORTRAITMODEL", "link": null},
        {"name": "model", "type": "COMBO", "widget": {"name": "model"}, "link": null},
        {"name": "base_precision", "type": "COMBO", "widget": {"name": "base_precision"}, "link": null},
        {"name": "quantization", "type": "COMBO", "widget": {"name": "quantization"}, "link": null},
        {"name": "load_device", "type": "COMBO", "widget": {"name": "load_device"}, "link": null},
        {"name": "attention_mode", "shape": 7, "type": "COMBO", "widget": {"name": "attention_mode"}, "link": null},
        {"name": "rms_norm_function", "shape": 7, "type": "COMBO", "widget": {"name": "rms_norm_function"}, "link": null},
        {"name": "vace_model", "shape": 7, "type": "VACEPATH", "link": null}
      ],
      "outputs": [
        {"name": "model", "type": "WANVIDEOMODEL", "links": [553]}
      ],
      "title": "WAN 2.1 I2V 14B FP8 Model",
      "properties": {"cnr_id": "ComfyUI-WanVideoWrapper", "ver": "058286fc0f3b0651a2f6b68309df3f06e8332cc0", "Node name for S&R": "WanVideoModelLoader", "widget_ue_connectable": {"model": true, "base_precision": true, "quantization": true, "load_device": true, "attention_mode": true}},
      "widgets_values": ["Wan2_1-I2V-14B-480P_fp8_e4m3fn.safetensors", "bf16", "disabled", "offload_device", "sageattn", "default"],
      "color": "#223",
      "bgcolor": "#335"
    },
    {
      "id": 128,
      "type": "WanVideoSampler",
      "pos": [-2712, -1354],
      "size": [391, 1123],
      "flags": {},
      "order": 22,
      "mode": 0,
      "inputs": [
        {"name": "model", "type": "WANVIDEOMODEL", "link": 553},
        {"name": "image_embeds", "type": "WANVIDIMAGE_EMBEDS", "link": 413},
        {"name": "text_embeds", "shape": 7, "type": "WANVIDEOTEXTEMBEDS", "link": 437},
        {"name": "samples", "shape": 7, "type": "LATENT", "link": null},
        {"name": "feta_args", "shape": 7, "type": "FETAARGS", "link": null},
        {"name": "context_options", "shape": 7, "type": "WANVIDCONTEXT", "link": null},
        {"name": "cache_args", "shape": 7, "type": "CACHEARGS", "link": null},
        {"name": "flowedit_args", "shape": 7, "type": "FLOWEDITARGS", "link": null},
        {"name": "slg_args", "shape": 7, "type": "SLGARGS", "link": null},
        {"name": "loop_args", "shape": 7, "type": "LOOPARGS", "link": null},
        {"name": "experimental_args", "shape": 7, "type": "EXPERIMENTALARGS", "link": null},
        {"name": "sigmas", "shape": 7, "type": "SIGMAS", "link": null},
        {"name": "unianimate_poses", "shape": 7, "type": "UNIANIMATE_POSE", "link": null},
        {"name": "fantasytalking_embeds", "shape": 7, "type": "FANTASYTALKING_EMBEDS", "link": null},
        {"name": "uni3c_embeds", "shape": 7, "type": "UNI3C_EMBEDS", "link": null},
        {"name": "multitalk_embeds", "shape": 7, "type": "MULTITALK_EMBEDS", "link": 357},
        {"name": "freeinit_args", "shape": 7, "type": "FREEINITARGS", "link": null},
        {"name": "steps", "type": "INT", "widget": {"name": "steps"}, "link": null},
        {"name": "cfg", "type": "FLOAT", "widget": {"name": "cfg"}, "link": null},
        {"name": "shift", "type": "FLOAT", "widget": {"name": "shift"}, "link": null},
        {"name": "seed", "type": "INT", "widget": {"name": "seed"}, "link": null},
        {"name": "force_offload", "type": "BOOLEAN", "widget": {"name": "force_offload"}, "link": null},
        {"name": "scheduler", "type": "COMBO", "widget": {"name": "scheduler"}, "link": null},
        {"name": "riflex_freq_index", "type": "INT", "widget": {"name": "riflex_freq_index"}, "link": null},
        {"name": "denoise_strength", "shape": 7, "type": "FLOAT", "widget": {"name": "denoise_strength"}, "link": null},
        {"name": "batched_cfg", "shape": 7, "type": "BOOLEAN", "widget": {"name": "batched_cfg"}, "link": null},
        {"name": "rope_function", "shape": 7, "type": "COMBO", "widget": {"name": "rope_function"}, "link": null},
        {"name": "start_step", "shape": 7, "type": "INT", "widget": {"name": "start_step"}, "link": null},
        {"name": "end_step", "shape": 7, "type": "INT", "widget": {"name": "end_step"}, "link": null},
        {"name": "add_noise_to_samples", "shape": 7, "type": "BOOLEAN", "widget": {"name": "add_noise_to_samples"}, "link": null}
      ],
      "outputs": [
        {"name": "samples", "type": "LATENT", "slot_index": 0, "links": [550]},
        {"name": "denoised_samples", "type": "LATENT", "links": null}
      ],
      "title": "Video Sampler",
      "properties": {"cnr_id": "ComfyUI-WanVideoWrapper", "ver": "c3ee35f3ece76e38099dc516182d69b406e16772", "Node name for S&R": "WanVideoSampler", "widget_ue_connectable": {"steps": true, "cfg": true, "shift": true, "seed": true, "force_offload": true, "scheduler": true, "riflex_freq_index": true, "denoise_strength": true, "batched_cfg": true, "rope_function": true, "start_step": true, "end_step": true, "add_noise_to_samples": true}},
      "widgets_values": [10, 1.2, 8.0, 791091094085035, "randomize", true, "dpm++_sde", 0, 1, false, "comfy", 0, -1, true],
      "color": "#322",
      "bgcolor": "#533"
    },
    {
      "id": 309,
      "type": "WanVideoPassImagesFromSamples",
      "pos": [-2289, -1447],
      "size": [322, 46],
      "flags": {},
      "order": 23,
      "mode": 0,
      "inputs": [
        {"name": "samples", "type": "LATENT", "link": 550}
      ],
      "outputs": [
        {"name": "images", "type": "IMAGE", "links": [561]},
        {"name": "output_path", "type": "STRING", "links": null}
      ],
      "title": "Decode Video Frames",
      "properties": {"cnr_id": "ComfyUI-WanVideoWrapper", "ver": "e5955d83958f1c808c86e5be3804ca42b39ab3fa", "Node name for S&R": "WanVideoPassImagesFromSamples", "widget_ue_connectable": {}},
      "widgets_values": []
    },
    {
      "id": 320,
      "type": "ImageResizeKJv2",
      "pos": [-1920, -1447],
      "size": [281, 420],
      "flags": {},
      "order": 24,
      "mode": 0,
      "inputs": [
        {"name": "image", "type": "IMAGE", "link": 561},
        {"name": "mask", "shape": 7, "type": "MASK", "link": null},
        {"name": "width", "type": "INT", "widget": {"name": "width"}, "link": null},
        {"name": "height", "type": "INT", "widget": {"name": "height"}, "link": null},
        {"name": "upscale_method", "type": "COMBO", "widget": {"name": "upscale_method"}, "link": null},
        {"name": "keep_proportion", "type": "COMBO", "widget": {"name": "keep_proportion"}, "link": null},
        {"name": "pad_color", "type": "STRING", "widget": {"name": "pad_color"}, "link": null},
        {"name": "crop_position", "type": "COMBO", "widget": {"name": "crop_position"}, "link": null},
        {"name": "divisible_by", "type": "INT", "widget": {"name": "divisible_by"}, "link": null},
        {"name": "device", "shape": 7, "type": "COMBO", "widget": {"name": "device"}, "link": null}
      ],
      "outputs": [
        {"name": "IMAGE", "type": "IMAGE", "links": [562]},
        {"name": "width", "type": "INT", "links": []},
        {"name": "height", "type": "INT", "links": []},
        {"name": "mask", "type": "MASK", "links": null}
      ],
      "title": "Upscale to TikTok (1080x1920)",
      "properties": {"cnr_id": "comfyui-kjnodes", "ver": "f7eb33abc80a2aded1b46dff0dd14d07856a7d50", "Node name for S&R": "ImageResizeKJv2", "widget_ue_connectable": {"width": true, "height": true, "upscale_method": true, "keep_proportion": true, "pad_color": true, "crop_position": true, "divisible_by": true, "device": true}},
      "widgets_values": [1080, 1920, "lanczos", "disabled", "0, 0, 0", "center", 2, "cpu"],
      "color": "#432",
      "bgcolor": "#653"
    },
    {
      "id": 318,
      "type": "VHS_VideoCombine",
      "pos": [-1580, -1447],
      "size": [500, 334],
      "flags": {},
      "order": 25,
      "mode": 0,
      "inputs": [
        {"name": "images", "type": "IMAGE", "link": 562},
        {"name": "audio", "shape": 7, "type": "AUDIO", "link": 563},
        {"name": "meta_batch", "shape": 7, "type": "VHS_BatchManager", "link": null},
        {"name": "vae", "shape": 7, "type": "VAE", "link": null},
        {"name": "frame_rate", "type": "FLOAT", "widget": {"name": "frame_rate"}, "link": null},
        {"name": "loop_count", "type": "INT", "widget": {"name": "loop_count"}, "link": null},
        {"name": "filename_prefix", "type": "STRING", "widget": {"name": "filename_prefix"}, "link": null},
        {"name": "format", "type": "COMBO", "widget": {"name": "format"}, "link": null},
        {"name": "pingpong", "type": "BOOLEAN", "widget": {"name": "pingpong"}, "link": null},
        {"name": "save_output", "type": "BOOLEAN", "widget": {"name": "save_output"}, "link": null},
        {"name": "pix_fmt", "type": ["yuv420p", "yuv420p10le"], "widget": {"name": "pix_fmt"}, "link": null},
        {"name": "crf", "type": "INT", "widget": {"name": "crf"}, "link": null},
        {"name": "save_metadata", "type": "BOOLEAN", "widget": {"name": "save_metadata"}, "link": null},
        {"name": "trim_to_audio", "type": "BOOLEAN", "widget": {"name": "trim_to_audio"}, "link": null}
      ],
      "outputs": [
        {"name": "Filenames", "type": "VHS_FILENAMES", "links": null}
      ],
      "title": "Export UGC Video (MP4 + Audio)",
      "properties": {"cnr_id": "comfyui-videohelpersuite", "ver": "0edce8ef7ce173ac97a3ed3d6f4636029d1a4530", "Node name for S&R": "VHS_VideoCombine", "widget_ue_connectable": {"frame_rate": true, "loop_count": true, "filename_prefix": true, "format": true, "pingpong": true, "save_output": true}},
      "widgets_values": {
        "frame_rate": 25,
        "loop_count": 0,
        "filename_prefix": "UGC_Video",
        "format": "video/h264-mp4",
        "pix_fmt": "yuv420p",
        "crf": 18,
        "save_metadata": true,
        "trim_to_audio": true,
        "pingpong": false,
        "save_output": true,
        "videopreview": {"hidden": false, "paused": false, "params": {}}
      },
      "color": "#232",
      "bgcolor": "#353"
    }
  ],
  "links": [
    [334, 137, 0, 194, 0, "WAV2VECMODEL"],
    [349, 138, 0, 122, 2, "WANVIDLORA"],
    [355, 120, 0, 122, 6, "MULTITALKMODEL"],
    [357, 194, 0, 128, 15, "MULTITALK_EMBEDS"],
    [362, 134, 0, 122, 1, "BLOCKSWAPARGS"],
    [413, 192, 0, 128, 1, "WANVIDIMAGE_EMBEDS"],
    [433, 237, 0, 192, 2, "WANVIDIMAGE_CLIPEMBEDS"],
    [437, 241, 0, 128, 2, "WANVIDEOTEXTEMBEDS"],
    [496, 284, 0, 281, 0, "IMAGE"],
    [516, 291, 1, 192, 3, "INT"],
    [517, 291, 2, 192, 4, "INT"],
    [538, 281, 0, 291, 0, "IMAGE"],
    [539, 291, 0, 237, 1, "IMAGE"],
    [540, 291, 0, 192, 1, "IMAGE"],
    [543, 301, 0, 302, 0, "MELROFORMERMODEL"],
    [544, 302, 0, 194, 1, "AUDIO"],
    [550, 128, 0, 309, 0, "LATENT"],
    [552, 177, 0, 122, 0, "WANCOMPILEARGS"],
    [553, 122, 0, 128, 0, "WANVIDEOMODEL"],
    [554, 125, 0, 302, 1, "AUDIO"],
    [556, 129, 0, 192, 0, "WANVAE"],
    [557, 238, 0, 237, 0, "CLIP_VISION"],
    [558, 194, 2, 293, 0, "*"],
    [561, 309, 0, 320, 0, "IMAGE"],
    [562, 320, 0, 318, 0, "IMAGE"],
    [563, 125, 0, 318, 1, "AUDIO"]
  ],
  "groups": [
    {
      "id": 1,
      "title": "INSTRUCTIONS",
      "bounding": [-5300, -1800, 1700, 450],
      "color": "#3f789e",
      "font_size": 24,
      "flags": {}
    },
    {
      "id": 2,
      "title": "INPUT: Avatar Image",
      "bounding": [-5250, -800, 750, 615],
      "color": "#8A4040",
      "font_size": 24,
      "flags": {}
    },
    {
      "id": 3,
      "title": "IMAGE: CLIP + VAE + Text Encoder",
      "bounding": [-4250, -800, 1500, 620],
      "color": "#40708A",
      "font_size": 24,
      "flags": {}
    },
    {
      "id": 4,
      "title": "INPUT: Voice Audio + Vocal Separation",
      "bounding": [-3700, -1530, 950, 700],
      "color": "#6A408A",
      "font_size": 24,
      "flags": {}
    },
    {
      "id": 5,
      "title": "MODEL: WAN 2.1 + InfiniteTalk + LoRA",
      "bounding": [-4920, -1530, 1250, 690],
      "color": "#3f5e9e",
      "font_size": 24,
      "flags": {}
    },
    {
      "id": 6,
      "title": "SAMPLER: Video Generation",
      "bounding": [-2750, -1530, 500, 1350],
      "color": "#8A4040",
      "font_size": 24,
      "flags": {}
    },
    {
      "id": 7,
      "title": "OUTPUT: Upscale + Export MP4",
      "bounding": [-2330, -1530, 1300, 520],
      "color": "#408A40",
      "font_size": 24,
      "flags": {}
    }
  ],
  "config": {},
  "extra": {
    "ds": {
      "scale": 0.6,
      "offset": [4000, 1800]
    },
    "frontendVersion": "1.27.7",
    "node_versions": {
      "ComfyUI-WanVideoWrapper": "0a11c67a0c0062b534178920a0d6dcaa75e7b5fe",
      "comfy-core": "0.3.50",
      "ComfyUI-MelBandRoFormer": "b68d9077815387b64d596f8c39607052b95b6eba",
      "ComfyUI-KJNodes": "f7eb33abc80a2aded1b46dff0dd14d07856a7d50",
      "comfyui-videohelpersuite": "0edce8ef7ce173ac97a3ed3d6f4636029d1a4530"
    },
    "info": {
      "name": "UGC Video Creator - InfiniteTalk Optimized",
      "description": "Workflow optimise pour creer des videos UGC (TikTok, Reels, Shorts) avec lip-sync automatique via InfiniteTalk",
      "version": "1.0",
      "pipeline": [
        "1. Load avatar image + resize 480x832",
        "2. Load audio + MelBandRoFormer vocal isolation",
        "3. CLIP Vision + VAE + UMT5 text encoding",
        "4. Wav2Vec audio embeddings for lip-sync",
        "5. WAN 2.1 I2V 14B FP8 + InfiniteTalk generation",
        "6. Lanczos upscale 480x832 -> 1080x1920",
        "7. H.264 MP4 export with audio sync"
      ],
      "vram_required": "16-24GB with block swap",
      "output_format": "1080x1920 9:16 (TikTok/Reels/Shorts)"
    },
    "VHS_latentpreview": false,
    "VHS_latentpreviewrate": 0,
    "VHS_MetadataImage": true,
    "VHS_KeepIntermediate": true,
    "ue_links": []
  },
  "version": 0.4
}